var _ = require('underscore');

function Response(data, stream){
    this.idStream = stream._id;
    this.id = data.id;
    this.stream = stream;
    this.write = this.send;
}

Response.prototype = {
    send: function(message){

        var messageCopy = _.clone(message);

        if( message ){
            if( !message.result && !message.errors ){
                message = {};
                message.result = messageCopy;
            }
        }else{
            message = {};
            message.result = {};
        }


        message.id = this.id;
        this.stream.write( JSON.stringify(message) );
    }
}

module.exports = Response;

