var HttpError = require('error').HttpError;
var socketServer = require('socketServer');
var server = socketServer();
exports.init =  function(httpServer){
    server.start(httpServer);
}
exports.server = server;
exports.channel = server.channel;

//add routing for client request
require('routes/websocket')(server);
// default route
server.use( function(req, res, next){
    console.log("default route2");
    next('wrong id');
});

server.use(function(err, req, res, next){

    if( typeof err == "number"){
        err = new HttpError(err);
    }

    if( err instanceof HttpError ){
        res.sendHttpError(err);
    }else{

    }

    /*
    next();
    next('wrong id');
    next(new Error('some text'))
    next(new HttpError(500, 'some text'));
     */

})