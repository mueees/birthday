var WebSocketServer = require('./server');
var crossroads = require('crossroads');
var route = require('routes/websocket');
var websocketChannel = require("./channel");

//add routing
route(crossroads);

module.exports = function(server){
    var websocketServer = new WebSocketServer(server, crossroads);
    websocketChannel.on("publish", websocketServer.publish)
}